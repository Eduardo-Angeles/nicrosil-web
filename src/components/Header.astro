---
import ThemeToggle from "./ThemeToggle.tsx";

const navLinks = [
  { href: "#servicios", label: "Servicios" },
  { href: "#filosofia", label: "Filosofía" },
  { href: "#proceso", label: "Proceso" },
  { href: "#contacto", label: "Contacto" },
];
---

<!-- El header es solo el contenedor sticky; el pill nav es el elemento visual -->
<header
  class="pointer-events-none fixed top-0 z-50 flex w-full justify-center px-4 py-4"
>
  <nav
    class="pointer-events-auto flex w-full max-w-3xl items-center justify-between gap-4 rounded-full border border-white/80 bg-white/70 px-3 py-2 shadow-sm backdrop-blur-md dark:border-white/10 dark:bg-zinc-900/70"
    aria-label="Navegación principal"
  >
    <!-- Logo -->
    <a
      href="/"
      class="flex shrink-0 items-center gap-2 pl-1"
      aria-label="Nicrosil — Inicio"
    >
      <img
        src="/favicon.svg"
        alt=""
        width="28"
        height="28"
        loading="eager"
        decoding="async"
        class="dark:invert"
        aria-hidden="true"
      />
      <span class="text-sm font-semibold text-zinc-900 dark:text-zinc-50">
        Nicrosil.Dev
      </span>
    </a>

    <!-- Divisor -->
    <div
      class="hidden h-7 w-px bg-zinc-200 md:block dark:bg-zinc-700"
      aria-hidden="true"
    >
    </div>

    <!-- Links desktop -->
    <ul
      class="hidden flex-1 items-center justify-center gap-7 md:flex"
      role="list"
    >
      {
        navLinks.map(({ href, label }) => (
          <li>
            <a
              href={href}
              class="text-sm text-zinc-500 transition-colors hover:text-cyan-600 dark:text-zinc-400 dark:hover:text-cyan-400"
            >
              {label}
            </a>
          </li>
        ))
      }
    </ul>

    <!-- Derecha: toggle + CTA + hamburger -->
    <div class="flex items-center gap-2 pr-1">
      <ThemeToggle client:load />

      <a
        href="#contacto"
        class="hidden rounded-full bg-cyan-600 px-5 py-2 text-xs font-semibold text-white transition-colors hover:bg-cyan-500 md:inline-flex dark:bg-cyan-500 dark:hover:bg-cyan-400"
      >
        Hablemos
      </a>

      <!-- Hamburger mobile -->
      <button
        id="hamburger"
        class="flex h-9 w-9 items-center justify-center rounded-full text-zinc-500 transition-colors hover:bg-zinc-100 md:hidden dark:text-zinc-400 dark:hover:bg-zinc-800"
        aria-label="Abrir menú"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg
          id="icon-menu"
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path d="M4 6h16"></path><path d="M4 12h16"></path><path d="M4 18h16"
          ></path>
        </svg>
        <svg
          id="icon-close"
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
          class="hidden"
        >
          <path d="M18 6 6 18"></path><path d="m6 6 12 12"></path>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Menú móvil — debajo del pill -->
  <div
    id="mobile-menu"
    class="pointer-events-auto absolute top-20 right-4 left-4 hidden rounded-2xl border border-white/80 bg-white/90 p-4 shadow-lg backdrop-blur-md dark:border-white/10 dark:bg-zinc-900/90"
    role="navigation"
    aria-label="Menú móvil"
  >
    <ul class="flex flex-col gap-1" role="list">
      {
        navLinks.map(({ href, label }) => (
          <li>
            <a
              href={href}
              class="mobile-nav-link block rounded-xl px-4 py-2.5 text-sm font-medium text-zinc-700 transition-colors hover:bg-zinc-100 hover:text-cyan-600 dark:text-zinc-300 dark:hover:bg-zinc-800 dark:hover:text-cyan-400"
            >
              {label}
            </a>
          </li>
        ))
      }
      <li class="mt-2">
        <a
          href="#contacto"
          class="mobile-nav-link block rounded-xl bg-cyan-600 px-4 py-2.5 text-center text-sm font-semibold text-white transition-colors hover:bg-cyan-500"
        >
          Hablemos
        </a>
      </li>
    </ul>
  </div>
</header>

<script>
  const hamburger = document.getElementById("hamburger");
  const mobileMenu = document.getElementById("mobile-menu");
  const iconMenu = document.getElementById("icon-menu");
  const iconClose = document.getElementById("icon-close");

  hamburger?.addEventListener("click", () => {
    const isOpen = !mobileMenu?.classList.toggle("hidden");
    hamburger.setAttribute("aria-expanded", String(isOpen));
    iconMenu?.classList.toggle("hidden", isOpen);
    iconClose?.classList.toggle("hidden", !isOpen);
  });

  document.querySelectorAll(".mobile-nav-link").forEach((link) => {
    link.addEventListener("click", () => {
      mobileMenu?.classList.add("hidden");
      hamburger?.setAttribute("aria-expanded", "false");
      iconMenu?.classList.remove("hidden");
      iconClose?.classList.add("hidden");
    });
  });
</script>
